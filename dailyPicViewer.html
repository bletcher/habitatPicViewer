<!DOCTYPE HTML>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Fish Data Visualizations | SHEDS</title>

  <link href="https://fonts.googleapis.com/css?family=Open+Sans:400,600,700" rel="stylesheet" type="text/css">
  <link rel="stylesheet" href="libs/bootstrap/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css">
  <link rel="stylesheet" href="libs/landing-page/css/landing-page.css" rel="stylesheet" type="text/css">
  <link rel="stylesheet" href="libs/font-awesome/css/font-awesome.min.css" rel="stylesheet" type="text/css">
  <link rel="stylesheet" href="libs/leaflet/dist/leaflet.css" rel="stylesheet" type="text/css">



<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/css/bootstrap.min.css" integrity="sha384-rwoIResjU2yc3z8GV/NPeZWAv56rSmLldC3R/AZzGRnGxQQKnKkoFVhFQhNUwEyJ" crossorigin="anonymous">
<script src="https://code.jquery.com/jquery-3.1.1.slim.min.js" integrity="sha384-A7FZj7v+d/sdmMqp/nOQwliLvUsJfDHW+k9Omg/a/EheAdgtzNs3hpfag6Ed950n" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/tether/1.4.0/js/tether.min.js" integrity="sha384-DztdAPBWPRXSA/3eYEEUWrWCy7G5KFbe8fFjk5JAIxUYHKkDx6Qin1DkWx51bBrb" crossorigin="anonymous"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/js/bootstrap.min.js" integrity="sha384-vBWWzlZJ8ea9aCX4pEW3rVHjgjt7zpkNpZk+02D9phzyeVkE+jo0ieGizqPLForn" crossorigin="anonymous"></script>



<script src="/libs/jquery/dist/jquery.min.js"></script>

<!-- <script src="/libs/bootstrap/dist/js/bootstrap.min.js"></script> 
<script src="/libs/intro.js/minified/intro.min.js"></script>
-->



  <style>
    body, h1, h2, h3, h4, h5, h6 {
      font-weight: 400;
      font-family: "Open Sans", Helvetica, Arial, sans-serif !important;
    }

    .top-section {
      background: #222;
      color: white;
    }
    
    .funding-section img {
      margin: 10px 25px 10px 25px;
    }


    div.tooltip {
      position: absolute;
      padding: 8px;
      font: 12px sans-serif;
      background: #C6C6C6;
      pointer-events: none;
      height: auto;
      width: 480px;
      text-align: center;
    }
    
    .object-fit_contain { object-fit: contain }
    
    img[class] { 
      width: 100%;
      height: 100%;
    }
    
    img2 {height:10%; width:10%; }
    
    .carousel-inner > .carousel-item > img,
    .carousel-inner > .carousel-item > a > img {
      width: 80%;
      margin: auto;
    }
    
    .carousel-caption {top: 2px;}
  </style>
</head>
<body>

  <div style="border-bottom: 2px solid #e7e7e7;background:#f8f8f8">
    <div class="container">
      <div class="row" style="margin-top: 20px; margin-bottom: 20px">
        <div class="col-xs-12">
          <h1>Daily pictures viewer</h1>
        </div>
      </div>
    </div>
  </div>


  <div class="content-section-b top-section">
    <div class="container">
      <div class="col-xs-6 col-md-6">
  
  
        <div id="carousel_Sawmill" class="carousel slide" data-ride="carousel">
          <ol class="carousel-indicators">
          </ol>

          <div class="carousel-inner" role="listbox">
          </div>
      
         <a class="carousel-control-prev" href="#carousel_Sawmill" role="button" data-slide="prev">
          <span class="carousel-control-prev-icon" aria-hidden="true"></span>
          <span class="sr-only">Previous</span>
        </a>
        <a class="carousel-control-next" href="#carousel_Sawmill" role="button" data-slide="next">
          <span class="carousel-control-next-icon" aria-hidden="true"></span>
          <span class="sr-only">Next</span>
        </a>
        
        </div>
      </div>
    </div>
  </div>

  <div class="content-section-b">
    <div class="container">
      <div class="row">
        <div class="col-xs-12 col-md-12">

          <h2>Sawmill River from the Montague Conservation Area bridge</h2>
          <div class="row" style="margin-top: 50px; margin-bottom: 20px">
            <div id="flickr-images_sawmill"></div>
          </div>  

        </div>
      </div>
    </div>
  </div>

  <div class="content-section-b top-section">
    <div class="container">
      <div class="row">
        <div class="col-xs-12 col-md-12">

          <h2>Montague Conservation Area</h2>
          <div class="row" style="margin-top: 50px; margin-bottom: 20px">
            <div id="flickr-images_consArea"></div>
          </div>  

        </div>
      </div>
    </div>
  </div>


  <div class="content-section-b">
    <div class="container">
      <div class="row">
        <div class="col-xs-12 col-md-8">
          <h2>Project Team</h2>
          <p>Ben Letcher  </p>

        </div>
      </div>
    </div>
  </div>


  <footer>
    <div class="container">
      <div class="row">
        <div class="col-xs-12">
          <p class="copyright text-muted">Copyright Â© 2016 SHEDS Development Team</p>
          <p class="copyright text-muted"><strong>Disclaimer:</strong> This web site (SHEDS) has not yet been approved by the U.S. Geological Survey (USGS). As such, it does not represent any official USGS finding or policy.</p>
        </div>
      </div>
    </div>
  </footer>



<script src="libs/leaflet/dist/leaflet.js"></script>
<script src="libs/d3/d3.min.js"></script>

<script>

var tooltip = d3.select("body").append("div")
  .attr("class", "tooltip")
  .style("opacity", 0);

function imgError(image) {
    image.onerror = "";
    image.src = "/img/noImage.gif";
    console.log('in error');
    return true;
}
 
function strToDate(s) {
  var  out = [new Date(s.substring(5,6) + "-" + s.substring(7,8) + "-" + s.substring(0,4)).toDateString()]
  out.push(   new Date(s.substring(5,6) + "-" + s.substring(7,8) + "-" + s.substring(0,4)) )
  return out
}  

function typeFlow(d){
  d.agency = d.agency_cd;
  d.site = d.site_no;
  d.date = Date.parse(d.datetime);
  d.flow = +d.flow;
  
  return d;
}
///////
//  
// http://www.lovelldsouza.com/webdev/flickr-to-website/


function getImgs(setID,setName) {
  var URL = "https://api.flickr.com/services/rest/" + 
    "?method=flickr.photosets.getPhotos" +  
    "&api_key=b17072d6e8c8f93662be1635ac49f557" +  
    "&photoset_id=" + setID +  // The set ID.
    "&user_id=155284079@N03" +
    "&privacy_filter=1" +  // 1 signifies all public photos.
    "&format=json&nojsoncallback=1"
    ;  

  console.log(URL);

  $.getJSON(URL, function(data){
    $.each(data.photoset.photo, function(i, item){
      var img_src = "http://farm" + item.farm + ".static.flickr.com/" + item.server + "/" + item.id + "_" + item.secret + "_m.jpg";
      var img_thumb = $("<img/>").attr("src", img_src).css("margin", "1px").css("width", "7.5%")
      $(img_thumb).appendTo("#flickr-images" + setName);

      if (setName == "_sawmill"){ 
        $('<div class="carousel-item"><img class="d-block img-fluid" src="' + img_src + '"><div class="carousel-caption d-none d-md-block"><h3>' + strToDate(item.title)[0] + ' </h3></div></div>').appendTo('.carousel-inner');
        
        $('<li data-target="#carousel_Sawmill" data-slide-to="'+ i +'"></li>').appendTo('.carousel-indicators');

      }

      //console.log(i,img_src, item)
      
      img_thumb
        .on("mouseover", function(d) {

        console.log("this", this, 'd', d, 'img', d.target.x, d.target.y)
        
        tooltip.html('<h3>' + item.title + '</h3><br><img class="object-fit-contain" src= ' + this.src + ' onerror="imgError(this);"/' + '>')
         // .style("right", "80px")// (d3.event.pageX + 15) + "px")
         // .style("top",  "200px")// (d3.event.pageY - 15) + "px")
  
          .style("left", d3.select('.col-xs-12').node().offsetWidth / 4 + 'px')     
          .style("top",  d.target.y + 0 + "px")
          .transition()
          .duration(100)
          .style("opacity", 1)
          
        })
        
        .on("mouseout", function (d) {
        d3.select(this)
      //    .transition()
      //    .duration(500)
      //    .style("width", "7.5%")
      
        tooltip.transition()
          .duration(250)
          .style("opacity", 0);
      
        })  
    
    });
    
    $('.carousel-item').first().addClass('active');
    $('.carousel-indicators > li').first().addClass('active');
  
  });
}

$(document).ready(function() {
  getImgs("72157681488505313","_sawmill"); 
  getImgs("72157681560511503","_consArea");
});  

d3.csv("/data/swiftRiverFlow.csv", typeFlow, function(flowIn) {

  console.log(flowIn)

});




</script>

</body>
</html>

